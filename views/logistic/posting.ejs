<button id="upload_widget" class="cloudinary-button" style="margin: 20px;">Upload files</button>

<script src="https://widget.cloudinary.com/v2.0/global/all.js" type="text/javascript"></script>  

<script type="text/javascript">  
var myWidget = cloudinary.createUploadWidget({
  cloudName: 'swaggyi', 
  apiKey: '264649938292219',
  uploadPreset: 'ya7unpjo'}, (error, result) => { 
    if (!error && result && result.event === "success") { 
      console.log('Done! Here is the image info: ', result.info); 
      fetch('/logistics/new', {
        method: 'POST',
        body: JSON.stringify({ url: result.info.secure_url }), 
        headers: { "Content-Type": "application/json; charset=utf-8"}
      })
      .then((response) => {
      })
      .catch(err => {
        console.log('error', err)
      })
    }
    else{
      console.log(error)
    }
  }
)

document.getElementById("upload_widget").addEventListener("click", function(){
    myWidget.open();
  }, false);
</script>

<form method="POST" action="/logistics/new">  
<input type="text" name="caption" placeholder="caption" style="margin: 20px;">
<button class="btn waves-effect waves-light blue-grey" type="submit">
  Submit
  <i class="material-icons left">chevron_right</i>
</button>
</form>